# ะััะธัะตะบัััะฐ ะะฐัะธะฝั ะกะพััะพัะฝะธะน ะฃัะพะฒะฝะตะน (Level State Machine)

## ๐ ะะฑะทะพั

ะัะพะตะบั HajjFlow ะธัะฟะพะปัะทัะตั ะฟะฐััะตัะฝ **State Machine** ะดะปั ัะฟัะฐะฒะปะตะฝะธั ััะพะฒะฝัะผะธ. ะะฐะถะดัะน ััะพะฒะตะฝั (Warmup, Miqat, Tawaf) ัะฒะปัะตััั ะพัะดะตะปัะฝัะผ ัะพััะพัะฝะธะตะผ ั ะผะตัะพะดะฐะผะธ ะถะธะทะฝะตะฝะฝะพะณะพ ัะธะบะปะฐ: `Enter()`, `Update()`, `Exit()`.

## ๐๏ธ ะกัััะบัััะฐ ะะปะฐััะพะฒ

### 1. **BaseLevelState** (ะะฑัััะฐะบัะฝัะน ะฑะฐะทะพะฒัะน ะบะปะฐัั)
**ะััั:** `Assets/Scripts/Core/States/BaseLevelState.cs`

ะะฐะทะพะฒัะน ะบะปะฐัั ะดะปั ะฒัะตั ัะพััะพัะฝะธะน ััะพะฒะฝะตะน. ะะฟัะตะดะตะปัะตั ะพะฑัะธะน ะธะฝัะตััะตะนั ะธ ะถะธะทะฝะตะฝะฝัะน ัะธะบะป.

**ะะตัะพะดั:**
- `Initialize(stateMachine, levelData)` - ะะฝะธัะธะฐะปะธะทะฐัะธั ัะพััะพัะฝะธั ั ะดะฐะฝะฝัะผะธ
- `Enter()` - ะัะทัะฒะฐะตััั ะฟัะธ ะฒัะพะดะต ะฒ ัะพััะพัะฝะธะต
- `Update()` - ะัะทัะฒะฐะตััั ะบะฐะถะดัะน ะบะฐะดั
- `Exit()` - ะัะทัะฒะฐะตััั ะฟัะธ ะฒััะพะดะต ะธะท ัะพััะพัะฝะธั
- `OnPause()` - ะัะทัะฒะฐะตััั ะฟัะธ ะฟะฐัะทะต
- `OnResume()` - ะัะทัะฒะฐะตััั ะฟัะธ ะฒะพะทะพะฑะฝะพะฒะปะตะฝะธะธ

**ะกะฒะพะนััะฒะฐ:**
- `StateId` - ะฃะฝะธะบะฐะปัะฝัะน ะธะดะตะฝัะธัะธะบะฐัะพั ัะพััะพัะฝะธั (abstract)

---

### 2. **LevelStateMachine** (ะะฐัะธะฝะฐ ัะพััะพัะฝะธะน)
**ะััั:** `Assets/Scripts/Core/States/LevelStateMachine.cs`

ะฃะฟัะฐะฒะปัะตั ะฟะตัะตัะพะดะฐะผะธ ะผะตะถะดั ัะพััะพัะฝะธัะผะธ ะธ ะฒัะทัะฒะฐะตั ะผะตัะพะดั ะถะธะทะฝะตะฝะฝะพะณะพ ัะธะบะปะฐ.

**ะะตัะพะดั:**
- `StartLevel(stateId, levelData)` - ะะฐะฟััะบะฐะตั ััะพะฒะตะฝั ั ัะบะฐะทะฐะฝะฝัะผ ัะพััะพัะฝะธะตะผ
- `ChangeState(stateId, levelData)` - ะะตัะตะบะปััะฐะตั ัะพััะพัะฝะธะต
- `Pause()` - ะกัะฐะฒะธั ะธะณัั ะฝะฐ ะฟะฐัะทั
- `Resume()` - ะะพะทะพะฑะฝะพะฒะปัะตั ะธะณัั
- `CompleteLevel(scorePercent)` - ะัะทัะฒะฐะตััั ัะพััะพัะฝะธะตะผ ะฟัะธ ะทะฐะฒะตััะตะฝะธะธ

**ะกะพะฑััะธั:**
- `OnStateChanged` - ะกัะฐะฑะฐััะฒะฐะตั ะฟัะธ ัะผะตะฝะต ัะพััะพัะฝะธั
- `OnLevelCompleted` - ะกัะฐะฑะฐััะฒะฐะตั ะฟัะธ ะทะฐะฒะตััะตะฝะธะธ ััะพะฒะฝั

**ะะฐัะตะณะธัััะธัะพะฒะฐะฝะฝัะต ัะพััะพัะฝะธั:**
- `"warmup"` โ WarmupLevelState
- `"miqat"` โ MiqatLevelState
- `"tawaf"` โ TawafLevelState

---

### 3. **WarmupLevelState** (ะกะพััะพัะฝะธะต ััะพะฒะฝั Warmup)
**ะััั:** `Assets/Scripts/Core/States/WarmupLevelState.cs`

ะะตัะฒัะน ะพะฑััะฐััะธะน ััะพะฒะตะฝั ะดะปั ะพะทะฝะฐะบะพะผะปะตะฝะธั ั ะธะณัะพะฒะพะน ะผะตัะฐะฝะธะบะพะน.

**ะัะพะฑะตะฝะฝะพััะธ:**
- ะะฐะทะพะฒะฐั ะฒะธะบัะพัะธะฝะฐ ะฑะตะท ะดะพะฟะพะปะฝะธัะตะปัะฝัั ะผะตัะฐะฝะธะบ
- ะะฐะทะฑะปะพะบะธััะตั ััะพะฒะตะฝั "miqat" ะฟัะธ ััะฟะตัะฝะพะผ ะฟัะพัะพะถะดะตะฝะธะธ
- ะะดะตะฐะปะตะฝ ะดะปั ะฝะพะฒะธัะบะพะฒ

**StateId:** `"warmup"`

---

### 4. **MiqatLevelState** (ะกะพััะพัะฝะธะต ััะพะฒะฝั Miqat)
**ะััั:** `Assets/Scripts/Core/States/MiqatLevelState.cs`

ะัะพัะพะน ััะพะฒะตะฝั, ะพะฑััะฐััะธะน ะฟัะฐะฒะธะปะฐะผ Miqat (ะผะตััะพ ะฟัะธะฝััะธั ะธััะฐะผะฐ).

**ะัะพะฑะตะฝะฝะพััะธ:**
- ะััะปะตะถะธะฒะฐะตั ะฒัะตะผั ะฟัะพัะพะถะดะตะฝะธั
- ะะพะฝัั +2 ะณะตะผะฐ ะทะฐ ะฑัััััะน ะพัะฒะตั (< 3 ะผะธะฝััั)
- ะะพะฝัั ะทะฐ ะพัะปะธัะฝัะน ัะตะทัะปััะฐั (โฅ 90%)
- ะะฐะทะฑะปะพะบะธััะตั ััะพะฒะตะฝั "tawaf" ะฟัะธ ััะฟะตัะฝะพะผ ะฟัะพัะพะถะดะตะฝะธะธ

**StateId:** `"miqat"`

---

### 5. **TawafLevelState** (ะกะพััะพัะฝะธะต ััะพะฒะฝั Tawaf)
**ะััั:** `Assets/Scripts/Core/States/TawafLevelState.cs`

ะขัะตัะธะน ััะพะฒะตะฝั, ะฟัะตะดััะฐะฒะปัััะธะน ัะฒััะตะฝะฝัะน ะพะฑัะพะด ะะฐะฐะฑั.

**ะัะพะฑะตะฝะฝะพััะธ:**
- ะกะธััะตะผะฐ "ะบััะณะพะฒ" (ะบะฐะถะดัะต 7 ะฒะพะฟัะพัะพะฒ = 1 ะบััะณ Tawaf)
- ะะพะฝัั ะทะฐ ัะตัะธั ะฟัะฐะฒะธะปัะฝัั ะพัะฒะตัะพะฒ (streak)
- ะัะพะฑัะน ะฑะพะฝัั +20 ะณะตะผะพะฒ ะทะฐ ะธะดะตะฐะปัะฝัะน ะบััะณ (7 ะฟัะฐะฒะธะปัะฝัั ะฟะพะดััะด)
- ะะพะปััะพะน ะฑะพะฝัั +50 ะณะตะผะพะฒ ะทะฐ 100% ะฟัะพัะพะถะดะตะฝะธะต
- ะกะฐะผัะน ัะปะพะถะฝัะน ััะพะฒะตะฝั

**StateId:** `"tawaf"`

---

## ๐ ะะพัะพะบ ะะฐะฑะพัั (Workflow)

### ะะฐะฟััะบ ะฃัะพะฒะฝั

```
1. LevelSelectionUI ะฒัะทัะฒะฐะตั:
   LevelManager.StartLevel(levelData, "warmup")
   
2. LevelManager ัะพััะฐะฝัะตั:
   - ActiveLevel = levelData
   - ActiveStateId = "warmup"
   - ะะฐะณััะถะฐะตั ััะตะฝั "Gameplay"
   
3. ะ Gameplay ััะตะฝะต GameplaySceneInitializer:
   - ะะพะปััะฐะตั LevelStateMachine
   - ะัะทัะฒะฐะตั LevelManager.RegisterStateMachine(stateMachine)
   
4. LevelManager.RegisterStateMachine:
   - ะกะพััะฐะฝัะตั ัััะปะบั ะฝะฐ StateMachine
   - ะัะทัะฒะฐะตั stateMachine.StartLevel(ActiveStateId, ActiveLevel)
   
5. LevelStateMachine.StartLevel:
   - ะะฐัะพะดะธั ัะพััะพัะฝะธะต ะฟะพ StateId ("warmup", "miqat", "tawaf")
   - ะัะทัะฒะฐะตั state.Initialize(stateMachine, levelData)
   - ะัะทัะฒะฐะตั state.Enter()
```

### ะะธะทะฝะตะฝะฝัะน ะฆะธะบะป ะกะพััะพัะฝะธั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ChangeState("warmup", levelData)      โ
โโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ
              โผ
      โโโโโโโโโโโโโโโโโ
      โ  Initialize() โ
      โโโโโโโโโฌโโโโโโโโ
              โ
              โผ
         โโโโโโโโโโโ
         โ Enter() โโโโโโโโโโโโโ
         โโโโโโฌโโโโโ           โ
              โ                โ
              โผ                โ
      โโโโโโโโโโโโโโโโ         โ
      โ   Update()   โโโโโโโโโโโ (ะบะฐะถะดัะน ะบะฐะดั)
      โโโโโโโโฌโโโโโโโโ
             โ
             โผ
        โโโโโโโโโโโ
        โ  Exit() โ
        โโโโโโโโโโโ
```

### ะะฐะฒะตััะตะฝะธะต ะฃัะพะฒะฝั

```
1. QuizSystem ะฒัะทัะฒะฐะตั OnQuizComplete(scorePercent)
   
2. ะกะพััะพัะฝะธะต (ะฝะฐะฟัะธะผะตั, WarmupLevelState):
   - ะกะพััะฐะฝัะตั ะฟัะพะณัะตัั ัะตัะตะท ProgressService
   - ะะฐะทะฑะปะพะบะธััะตั ัะปะตะดัััะธะน ััะพะฒะตะฝั
   - ะัะทัะฒะฐะตั _stateMachine.CompleteLevel(scorePercent)
   
3. LevelStateMachine ะฒัะทัะฒะฐะตั ัะพะฑััะธะต:
   OnLevelCompleted?.Invoke(stateId, scorePercent)
   
4. GameplaySceneInitializer ะฟะตัะตะฝะฐะฟัะฐะฒะปัะตั ะฝะฐ:
   LevelManager.ShowResults()
```

---

## ๐ฎ ะกัััะบัััะฐ ะกัะตะฝั Gameplay

ะะตะบะพะผะตะฝะดัะตะผะฐั ะธะตัะฐััะธั GameObject'ะพะฒ ะฒ ััะตะฝะต Gameplay:

```
Gameplay (Scene)
โโโ GameController (Empty GameObject)
โ   โโโ LevelStateMachine (Component)
โ   โโโ GameplaySceneInitializer (Component)
โ
โโโ Systems (Empty GameObject)
โ   โโโ QuizSystem (GameObject + QuizSystem Component)
โ   โโโ RewardSystem (GameObject + RewardSystem Component)
โ
โโโ UI (Canvas)
โ   โโโ TopBar
โ   โ   โโโ LevelName (TextMeshProUGUI)
โ   โ   โโโ Progress (TextMeshProUGUI)
โ   โ   โโโ Gems (TextMeshProUGUI)
โ   โ
โ   โโโ QuizPanel
โ   โ   โโโ QuestionText (TextMeshProUGUI)
โ   โ   โโโ OptionsGroup
โ   โ   โ   โโโ OptionA (Button + TMP)
โ   โ   โ   โโโ OptionB (Button + TMP)
โ   โ   โ   โโโ OptionC (Button + TMP)
โ   โ   โ   โโโ OptionD (Button + TMP)
โ   โ   โโโ FeedbackText (TextMeshProUGUI)
โ   โ   โโโ NextButton (Button + TMP)
โ   โ
โ   โโโ Navigation
โ       โโโ BackButton (Button)
โ       โโโ RestartButton (Button)
โ       โโโ PauseButton (Button)
โ
โโโ Environment (Optional)
    โโโ Background
    โโโ 3D Models (Kaaba for Tawaf, etc.)
    โโโ Lighting
```

### ะะฐัััะพะนะบะฐ ะฒ Inspector

#### GameController:
1. ะะพะฑะฐะฒััะต ะบะพะผะฟะพะฝะตะฝั `LevelStateMachine`
2. ะะพะฑะฐะฒััะต ะบะพะผะฟะพะฝะตะฝั `GameplaySceneInitializer`

#### GameplayUI (ะฝะฐ Canvas ะธะปะธ UI root):
- **Top Bar:** ะะฐะทะฝะฐัััะต TextMeshProUGUI ะดะปั LevelName, Progress, Gems
- **Quiz Panel:** ะะฐะทะฝะฐัััะต QuestionText, 4 ะบะฝะพะฟะบะธ Options, FeedbackText, NextButton
- **Navigation:** ะะฐะทะฝะฐัััะต BackButton, RestartButton
- **Systems:** ะะตัะตัะฐัะธัะต QuizSystem ะธ RewardSystem ะธะท ััะตะฝั

---

## ๐ ะะธะฐะณัะฐะผะผะฐ ะะตัะตัะพะดะพะฒ ะกะพััะพัะฝะธะน

```
    โโโโโโโโโโโโ
    โ MainMenu โ
    โโโโโโฌโโโโโโ
         โ
         โผ
  โโโโโโโโโโโโโโโโ
  โ Level Select โ
  โโโโโโโโฌโโโโโโโโ
         โ
         โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
         โผ             โผ             โผ
    โโโโโโโโโโโ  โโโโโโโโโโโ  โโโโโโโโโโโ
    โ Warmup  โ  โ Miqat   โ  โ Tawaf   โ
    โ State   โ  โ State   โ  โ State   โ
    โโโโโโฌโโโโโ  โโโโโโฌโโโโโ  โโโโโโฌโโโโโ
         โ            โ            โ
         โโโโโโโโโโโโโโดโโโโโโโโโโโโโ
                     โ
                     โผ
              โโโโโโโโโโโโโ
              โ  Results  โ
              โโโโโโโโโโโโโ
```

---

## ๐ ะกะธััะตะผะฐ ะะฐะณัะฐะด (Rewards)

### Warmup:
- ะะฐะทะพะฒัะต ะฝะฐะณัะฐะดั ะทะฐ ะฟัะฐะฒะธะปัะฝัะต ะพัะฒะตัั
- ะะตะท ัะฟะตัะธะฐะปัะฝัั ะฑะพะฝััะพะฒ

### Miqat:
- ะะฐะทะพะฒัะต ะฝะฐะณัะฐะดั ะทะฐ ะฟัะฐะฒะธะปัะฝัะต ะพัะฒะตัั
- **Speed Bonus:** +2 ะณะตะผะฐ ะทะฐ ะฑัััััะต ะพัะฒะตัั (< 3 ะผะธะฝ)
- **Excellence Bonus:** +50% ะพั CompletionBonusGems ะทะฐ ัะตะทัะปััะฐั โฅ 90%

### Tawaf:
- ะะฐะทะพะฒัะต ะฝะฐะณัะฐะดั ะทะฐ ะฟัะฐะฒะธะปัะฝัะต ะพัะฒะตัั
- **Streak Bonus:** ะกะตัะธั ะฟัะฐะฒะธะปัะฝัั ะพัะฒะตัะพะฒ ร 2 ะณะตะผะฐ (ะฝะฐัะธะฝะฐั ั 3-ะน ัะตัะธะธ)
- **Perfect Circle:** +20 ะณะตะผะพะฒ ะทะฐ 7 ะฟัะฐะฒะธะปัะฝัั ะพัะฒะตัะพะฒ ะฟะพะดััะด
- **Perfect Tawaf:** +50 ะณะตะผะพะฒ ะทะฐ 100% ะฟัะพัะพะถะดะตะฝะธะต

---

## ๐ง ะะฐััะธัะตะฝะธะต ะกะธััะตะผั

### ะะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒะพะณะพ ัะพััะพัะฝะธั:

1. ะกะพะทะดะฐะนัะต ะบะปะฐัั, ะฝะฐัะปะตะดัััะธะน `BaseLevelState`:
```csharp
public class NewLevelState : BaseLevelState
{
    public override string StateId => "new_level";
    
    public override void Enter() { /* ... */ }
    public override void Update() { /* ... */ }
    public override void Exit() { /* ... */ }
}
```

2. ะะฐัะตะณะธัััะธััะนัะต ะฒ `LevelStateMachine.RegisterStates()`:
```csharp
RegisterState(new NewLevelState());
```

3. ะัะฟะพะปัะทัะนัะต ะฟัะธ ะทะฐะฟััะบะต:
```csharp
LevelManager.StartLevel(levelData, "new_level");
```

---

## ๐ ะัะธะผะตัั ะัะฟะพะปัะทะพะฒะฐะฝะธั

### ะะฐะฟััะบ ััะพะฒะฝั Warmup:
```csharp
LevelData warmupLevel = Resources.Load<LevelData>("Levels/WarmupLevel");
LevelManager.StartLevel(warmupLevel, "warmup");
```

### ะะฐะฟััะบ ััะพะฒะฝั Miqat:
```csharp
LevelData miqatLevel = Resources.Load<LevelData>("Levels/MiqatLevel");
LevelManager.StartLevel(miqatLevel, "miqat");
```

### ะะฐะฟััะบ ััะพะฒะฝั Tawaf:
```csharp
LevelData tawafLevel = Resources.Load<LevelData>("Levels/TawafLevel");
LevelManager.StartLevel(tawafLevel, "tawaf");
```

### ะะตัะตะบะปััะตะฝะธะต ัะพััะพัะฝะธั ะฒะพ ะฒัะตะผั ะธะณัั:
```csharp
// ะงะตัะตะท LevelStateMachine
LevelManager.StateMachine.ChangeState("miqat", newLevelData);
```

### ะะฐัะทะฐ/ะะพะทะพะฑะฝะพะฒะปะตะฝะธะต:
```csharp
LevelManager.StateMachine.Pause();
LevelManager.StateMachine.Resume();
```

---

## โ ะัะตะธะผััะตััะฒะฐ ะััะธัะตะบัััั

1. **ะะฐะทะดะตะปะตะฝะธะต ะพัะฒะตัััะฒะตะฝะฝะพััะธ:** ะะฐะถะดะพะต ัะพััะพัะฝะธะต ะธะฝะบะฐะฟััะปะธััะตั ะปะพะณะธะบั ัะฒะพะตะณะพ ััะพะฒะฝั
2. **ะะฐััะธััะตะผะพััั:** ะะตะณะบะพ ะดะพะฑะฐะฒะธัั ะฝะพะฒัะต ััะพะฒะฝะธ ะฑะตะท ะธะทะผะตะฝะตะฝะธั ัััะตััะฒัััะตะณะพ ะบะพะดะฐ
3. **ะขะตััะธััะตะผะพััั:** ะะฐะถะดะพะต ัะพััะพัะฝะธะต ะผะพะถะฝะพ ัะตััะธัะพะฒะฐัั ะฝะตะทะฐะฒะธัะธะผะพ
4. **ะงะธัััะน ะบะพะด:** ะงะตัะบะธะต ัะพัะบะธ ะฒัะพะดะฐ/ะฒััะพะดะฐ ะธ ะถะธะทะฝะตะฝะฝัะน ัะธะบะป
5. **ะะธะฑะบะพััั:** ะะตะณะบะพ ะดะพะฑะฐะฒะธัั ัะฟะตัะธัะธัะฝัั ะปะพะณะธะบั ะดะปั ะบะฐะถะดะพะณะพ ััะพะฒะฝั

---

## ๐ฏ ะะฝัะตะณัะฐัะธั ั ะกััะตััะฒัััะธะผะธ ะกะธััะตะผะฐะผะธ

### QuizSystem
ะะฐะถะดะพะต ัะพััะพัะฝะธะต ะฟะพะดะฟะธััะฒะฐะตััั ะฝะฐ ัะพะฑััะธั QuizSystem:
- `OnQuestionReady` - ะะพะฒัะน ะฒะพะฟัะพั ะณะพัะพะฒ
- `OnAnswerResult` - ะะตะทัะปััะฐั ะพัะฒะตัะฐ
- `OnQuizComplete` - ะะธะบัะพัะธะฝะฐ ะทะฐะฒะตััะตะฝะฐ

### RewardSystem
ะกะพััะพัะฝะธั ะผะพะณัั ะฝะฐะณัะฐะถะดะฐัั ะธะณัะพะบะฐ ัะตัะตะท RewardSystem:
```csharp
_rewardSystem?.AwardGems(amount);
```

### ProgressService
ะกะพััะพัะฝะธั ัะพััะฐะฝััั ะฟัะพะณัะตัั ัะตัะตะท GameManager:
```csharp
GameManager.Instance.ProgressService.UpdateLevelProgress(levelId, scorePercent);
GameManager.Instance.ProgressService.UnlockLevel(nextLevelId);
```

---

## ๐ ะกะปะตะดัััะธะต ะจะฐะณะธ

1. **ะ Unity Editor:**
   - ะัะบัะพะนัะต ััะตะฝั Gameplay
   - ะกะพะทะดะฐะนัะต GameObject "GameController"
   - ะะพะฑะฐะฒััะต ะบะพะผะฟะพะฝะตะฝัั: `LevelStateMachine` ะธ `GameplaySceneInitializer`
   - ะะฐัััะพะนัะต ัััะปะบะธ ะฒ GameplayUI

2. **ะกะพะทะดะฐะนัะต LevelData ScriptableObjects:**
   - Assets โ Create โ Manasik โ Level Data
   - ะกะพะทะดะฐะนัะต 3 ััะพะฒะฝั: Warmup, Miqat, Tawaf
   - ะะฐะทะฝะฐัััะต StateId ัะพะพัะฒะตัััะฒะตะฝะฝะพ

3. **ะะฑะฝะพะฒะธัะต LevelSelectionUI:**
   - ะัะฟะพะปัะทัะนัะต `LevelManager.StartLevel(levelData, stateId)`
   - ะะตัะตะดะฐะฒะฐะนัะต ะฟัะฐะฒะธะปัะฝัะน stateId ะดะปั ะบะฐะถะดะพะณะพ ััะพะฒะฝั

---

## ๐ API Reference

### LevelManager
```csharp
// ะะฐะฟัััะธัั ััะพะฒะตะฝั ั ัะพััะพัะฝะธะตะผ
LevelManager.StartLevel(levelData, "warmup");

// ะะตัะตะทะฐะฟัััะธัั ัะตะบััะธะน ััะพะฒะตะฝั
LevelManager.RestartLevel();

// ะะตัะฝััััั ะบ ะฒัะฑะพัั ััะพะฒะฝั
LevelManager.GoToLevelSelect();

// ะะพะบะฐะทะฐัั ัะตะทัะปััะฐัั
LevelManager.ShowResults();

// ะะพัััะฟ ะบ ะฐะบัะธะฒะฝะพะผั ััะพะฒะฝั
LevelData level = LevelManager.ActiveLevel;
string stateId = LevelManager.ActiveStateId;
LevelStateMachine sm = LevelManager.StateMachine;
```

### LevelStateMachine
```csharp
// ะะพะปััะธัั ัะตะบััะตะต ัะพััะพัะฝะธะต
BaseLevelState current = stateMachine.CurrentState;

// ะัะพะฒะตัะธัั ะฟะฐัะทั
bool isPaused = stateMachine.IsPaused;

// ะฃะฟัะฐะฒะปะตะฝะธะต ะฟะฐัะทะพะน
stateMachine.Pause();
stateMachine.Resume();

// ะะพะดะฟะธัะฐัััั ะฝะฐ ัะพะฑััะธั
stateMachine.OnStateChanged += (state) => { /* ... */ };
stateMachine.OnLevelCompleted += (stateId, score) => { /* ... */ };
```

---

## ๐จ ะะธะทัะฐะปัะฝะฐั ะกัััะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    LevelManager                         โ
โ  (ะกัะฐัะธัะตัะบะธะน ะบะปะฐัั ะดะปั ัะฟัะฐะฒะปะตะฝะธั ััะตะฝะฐะผะธ ะธ ััะพะฒะฝัะผะธ)  โ
โโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                        โ
                        โผ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        โ     LevelStateMachine         โ
        โ  (MonoBehaviour ะฒ Gameplay)   โ
        โโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโ
                โ
                โโโโโโโโโโโฌโโโโโโโโโโโฌโโโโโโโโโโ
                โผ         โผ          โผ         
        โโโโโโโโโโโ โโโโโโโโโโโ โโโโโโโโโโโ
        โ Warmup  โ โ Miqat   โ โ Tawaf   โ
        โ State   โ โ State   โ โ State   โ
        โโโโโโโโโโโ โโโโโโโโโโโ โโโโโโโโโโโ
             โ           โ           โ
             โโโโโโโโโโโโโดโโโโโโโโโโโโ
                        โ
                        โผ
              โโโโโโโโโโโโโโโโโโโโ
              โ   QuizSystem     โ
              โ   RewardSystem   โ
              โ   ProgressServiceโ
              โโโโโโโโโโโโโโโโโโโโ
```

---

*ะะฐัะฐ ัะพะทะดะฐะฝะธั: 21 ัะตะฒัะฐะปั 2026*

